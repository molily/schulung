<!DOCTYPE html>
<html lang="de">

  <head>
    <meta charset="utf-8">

    <title>JavaScript-Workshop</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/simple.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
  </head>

  <body>

    <div class="reveal">
      <div class="slides">

<!-- ******************************************************************** -->

<section>
<svg width="150" height="150" viewBox="0 0 630 630">
  <rect x="0" y="0" width="100%" height="100%" fill="#f7df1e" />
  <path d="m 165.65,526.47375 48.2125,-29.1775 C 223.16375,513.7875 231.625,527.74 251.92,527.74 c 19.45375,0 31.71875,-7.60975 31.71875,-37.21 l 0,-201.3 59.20375,0 0,202.1375 c 0,61.32 -35.94375,89.23125 -88.385,89.23125 -47.36125,0 -74.8525,-24.52875 -88.8075,-54.13" />
  <path d="m 375,520.13 48.20625,-27.91125 c 12.69,20.72375 29.1825,35.9475 58.36125,35.9475 24.53125,0 40.17375,-12.26475 40.17375,-29.18125 0,-20.29875 -16.06875,-27.48875 -43.135,-39.32625 l -14.7975,-6.3475 c -42.715,-18.18125 -71.05,-41.0175 -71.05,-89.2275 0,-44.40375 33.83125,-78.2375 86.695,-78.2375 37.6375,0 64.7025,13.11125 84.15375,47.36625 l -46.09625,29.60125 c -10.15,-18.1825 -21.1425,-25.37125 -38.0575,-25.37125 -17.33875,0 -28.335,10.995 -28.335,25.37125 0,17.7625 10.99625,24.9525 36.3675,35.94875 l 14.8,6.3425 c 50.325,21.56875 78.66,43.5575 78.66,93.03375 0,53.2875 -41.86625,82.465 -98.11,82.465 -54.97625,0 -90.5,-26.2175 -107.83625,-60.47375" />
</svg>
<h1>JavaScript-Workshop</h1>
<h2>Grundlagen, OOP, jQuery, Backbone.js, MVC, Chaplin.js</h2>
</section>

<section>
<h1>Mathias Schäfer</h1>

<ul>
  <li>Software-Entwickler bei 9elements</li>
  <li>Studium der Germanistik und Philosophie</li>
  <li>Spezialisiert auf Frontend-Techniken HTML, CSS und JavaScript</li>
  <li>Autor von <a href="http://molily.de/weblog/artikel">Fachartikeln</a> und <a href="http://molily.de/js/">Dokumentationen</a> (u.a. SELFHTML, Webkrauts)</li>
  <li>Über 10 Jahre JavaScript-Erfahrung</li>
  <li>Initiator von <a href="http://chaplinjs.org">Chaplin.js</a></li>
</ul>
</section>

<section>
<h1><a href="http://9elements.com">9elements</a></h1>

<ul>
  <li>Bochum &amp; Berlin</li>
  <li>Design, Interfaces, Programmierung</li>
  <li>früher Flash- und Spiele-Entwicklung</li>
  <li>Webanwendungen mit Ruby on Rails</li>
  <li>HTML5- und JavaScript-Apps</li>
  <li>iOS- und Android-Entwicklung</li>
</ul>
</section>

<section>
<h1>Programm</h1>
<ol>
  <li>Sprachgrundlagen</li>
  <li>JavaScript in HTML, jQuery</li>
  <li>Strukturierung: OOP und funktionale Programmierung</li>
  <li>Anwendungen mit Backbone.js und Chaplin.js</li>
</ol>
</section>

<section>
<h1>Werkzeuge</h1>

<ul>
  <li>Editor (Sublime, WebStorm, Aptana, Zend)</li>
  <li>Browser mit Konsole und Debugger (Chrome/Web Inspector, Firefox/Firebug)</li>
  <li>Webserver (Apache, nginx)</li>
  <li>Git und das Schulungs-Repository</li>
  <li>EtherPad</li>
</ul>
</section>

<section>
<h1>Ablauf</h1>

<ul>
  <li>Vortrag mit Fragen und Antworten</li>
  <li>Aufgaben und Beispiele</li>
  <li>Umsetzungen besprechen, Refactoring</li>
  <li>Mitmachen und Ausprobieren auf der Konsole</li>
</ul>
</section>

<!-- ******************************************************************** -->

<section>
<h1>Was ist JavaScript?</h1>
<ul>
  <li>Eine interpretierte, dynamische, multiparadigmatische, universell einsetzbare Programmiersprache</li>
  <li>Schwach und dynamisch typisiert</li>
  <li>Durch Lisp und Scheme beeinflusst</li>
</ul>
</section>

<section>
<h1>Geschichte</h1>
<ul>
  <li>Netscape Navigator 2.0, 1995</li>
  <li>Scripting im Web-Browser</li>
  <li>Beginn des kommerziellen, allgemein zugänglichen WWW</li>
  <li>Ursprünglich zum Scripting von Java-Applets konzipiert</li>
  <li>»Java is to JavaScript as ham is to hamster«</li>
</ul>
</section>

<section>
<h1>Entwicklung</h1>
<ul>
  <li>Andere Browser implementierten JavaScript</li>
  <li>Standardisierung als ECMAScript
    <ul>
      <li>Edition 1: 1997</li>
      <li>Edition 3: 1999</li>
      <li>Edition 5.1: 2011</li>
      <li>Edition 6: 2015</li>
    </ul>
  </li>
  <li>Standardisierung der Browser-APIs</li>
  <li>Buzzwords: DHTML, Ajax, HTML5…</li>
</ul>
</section>

<section>
<h1>Verbreitung</h1>
<ul>
  <li>Open-Web-Plattform<br /><small>(HTML, CSS, JavaScript, DOM, HTTP, XML, JSON, SVG, PNG, JPEG etc.)</small></li>
  <li>Node.js, CommonJS-Implementierungen</li>
  <li>Desktop-Widgets, Windows-8-Apps</li>
</ul>
</section>

<section>
<h1>Heutiger Stand</h1>
<ul>
  <li>JavaScript ist überall und gewinnt an Einfluss</li>
  <li>»The World’s Most Popular Programming Language«</li>
  <li>Ausgereifte Interpreter von Apple, Microsoft, Google, Mozilla, Opera</li>
  <li>Davon mehrere Open Source (V8, SpiderMonkey, JavaScriptCore, Nashorn)</li>
</ul>
</section>

<section>
<h1>Standards</h1>

<ul>
  <li>ECMAScript (<a href="http://es5.github.com">es5.github.com</a>)</li>
  <li>W3C (<a href="http://w3.org">w3.org</a>)
    <ul>
      <li><a href="http://www.w3.org/TR/html5/">HTML WG</a>, <a href="http://www.w3.org/2008/webapps/wiki/PubStatus">WebApps WG</a> usw.</li>
      <li>Community Groups</li>
    </ul>
  </li>
  <li>WHATWG (<a href="http://www.whatwg.org/specs/">whatwg.org</a>)
    <ul>
      <li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/">HTML, DOM</a> usw.</li>
    </ul>
  </li>
  <li><a href="http://molily.de/weblog/html5-specs">Übersicht</a></li>
</ul>
</section>

<section>
<h1>JavaScript-Grundlagen</h1>

<pre><code class="javascript">window.alert("Hello World!");</code></pre>
</section>

<section>
<h1>JavaScript-Grundlagen</h1>

<pre><code class="javascript">window.alert("Hello World!");</code></pre>

<ul>
  <li>Objekt <code>window</code></li>
  <li>Eigenschaft <code>alert</code></li>
  <li>Eigenschaftswert: Funktion</li>
  <li>Funktionsaufruf <code>()</code></li>
  <li>String-Literal <code>"Hello World!"</code> als Funktionsparameter</li>
  <li>Semikolon am Zeilenende</li>
</ul>
</section>

<section>
<h1>Syntax</h1>

<p>Programmcode besteht aus…</p>

<ol>
  <li>Statements (u.a. Kontrollstrukturen)</li>
  <li>Expressions (Ausdrücke)</li>
  <li>Bezeichner, Literale und Operatoren</li>
</ol>

<p>vgl. Text – Abschnitt – Satz – Satzglied –<br />Wort – Morphem – Buchstabe</p>
</section>

<section>
<h1>Statements</h1>

<ul>
  <li>»Expression Statements« (Ausdrücke)
    <ul>
      <li><code>window.alert("Hello World!");</code></li>
    </ul>
  </li>
  <li>Variablen-Deklarationen</li>
  <li>Bedingte Anweisungen (if-else, switch)</li>
  <li>Schleifen (while, do-while, for, for-in; continue, break)</li>
  <li>Ausnahmebehandlung (try-catch-finally/throw)</li>
</ul>
</section>

<section>
<h1>Variablen</h1>

<pre><code class="javascript">var one = 1;
var two = 2;
var three = one + two,
    four = 4,
    result = three + four;
alert(result);
</code></pre>

</section>

<section>
<h1>Variablen</h1>

<p>Globale Variablen sind Eigenschaften des globalen Objekts <code>window</code>:</p>

<pre><code class="javascript">var one = 1;
alert(one); // 1
alert(window.one); // 1
</code></pre>

<p>Gundregel: Globale Variablen vermeiden.</p>

<p>JSLint/JSHint warnt vor globalen Variablen.</p>
</section>

<section>
<h1>Schleifen und Bedingungen</h1>

<pre><code class="javascript">var ausgabe;
for (var i = 1; i &lt;= 10; i++) {
  if (i % 2 == 0) {
    ausgabe = "gerade";
  } else {
    ausgabe = "ungerade";
  }
  alert(i + " ist " + ausgabe);
}
</code></pre>

<pre><code class="javascript">var name = "";
while (name == "") {
  name = window.prompt("Wie ist ihr Name?");
}</code></pre>

</section>

<section>
<h1>Syntax verstehen</h1>

<p>Abstrakte Syntaxbäume (AST)</p>

<pre><code class="javascript">window.alert("Hello World!");</code></pre>

<pre><code>Program
  ExpressionStatement
    CallExpression
      MemberExpression
        Identifier: window
        Identifier: alert
      arguments:
        Literal: "Hello World!"
</code></pre>

<p>Bspw. <a href="http://esprima.org/demo/parse.html?code=window.alert(%22Hello%20World!%22)%3B">Esprima ECMAScript parser</a></p>

</section>

<section>
<h1>Funktionen</h1>

<p>Funktionsausdruck (Function Expression)</p>

<pre>&lt;code contenteditable<code class="javascript">var add = function (a, b) {
  return a + b;
};
var sum = add(2, 3);
</code></pre>

<p>Funktionsdeklaration (Function Declaration)</p>

<pre><code class="javascript">var sum = add(2, 3);
function add (a, b) {
  return a + b;
}
</code></pre>

<p>Viele Fallstricke, daher besser vermeiden.</p>

</section>

<section>
<h1>Funktionen</h1>

<pre><code class="javascript">var add = function (a, b) {
  return a + b;
};
var sum = add(2, 3);
</code></pre>

<p>Einfacher und konsistenter</p>
</section>

<section>
<h1>Programmieraufgabe</h1>

<p>Schreiben Sie eine Funktion, die eine positive ganze Zahl entgegennimmt und die Summe der ganzen Zahlen von 1 bis zur gegebenen Zahl zurückgibt.</p>

<p>Beispiel: 5</p>

<p>1 + 2 + 3 + 4 + 5 = 15</p>
</section>

<section>
<h1>Umsetzungshilfe</h1>

<ul>
  <li>Funktion mit Parameter n</li>
  <li>Variable für Ergebnis</li>
  <li>Schleife, die von 1 bis n zählt</li>
  <li>Addition</li>
  <li>Rückgabewert</li>
</ul>
</section>

<section>
<h1>Mögliche Lösung</h1>

<pre><code class="javascript">var sum = function (n) {
  var result = 0;
  for (var i = 1; i &lt;= n; i++) {
    result += i;
  }
  return result;
};
alert( sum(5) );
</code></pre>

</section>

<section>
<h1>Lokale Variablen</h1>

<pre><code class="javascript">var max = function (list) {
  var i, l = list.length, biggest = 0, candidate;
  for (i = 0; i &lt; l; i++) {
    candidate = list[i];
    if (candidate &gt; biggest) {
      biggest = candidate;
    }
  }
  return biggest;
};
alert( max( [65, 24, 98, 44] ) ); // 98
alert(biggest); // ReferenceError: max is not defined
</code></pre>

</section>

<section>
<h1>Grundlegende Datentypen</h1>
<ul>
  <li>Einfache Werte (Primitives)
    <ul>
      <li>Boolean, Number, String</li>
      <li><code>undefined</code>, <code>null</code></li>
    </ul>
  </li>
  <li>Object</li>
  <li>Array</li>
  <li>Function</li>
  <li>RegExp, Date
&lt;/code&gt;&lt;/pre&gt;</li>
</ul>
</section>

<section>
<h1>Einfache Werte</h1>
<ul>
  <li>Boolean: <code>true</code>, <code>false</code></li>
  <li>Number: <code>0</code>, <code>1</code>, <code>2</code>, <code>3.75</code>, <code>-56.1</code>, <code>1e6</code>, <code>0x10</code></li>
  <li>String: <code>"Hühnerstall"</code>, <code>'Motorrad'</code></li>
</ul>
</section>

<section>
<h1>Einfache Werte</h1>

<p>Verhalten sich wie Objekte, besitzen Methoden:</p>

<pre><code class="javascript">(2.5172).toFixed(2) // 2.52
"Hello World".indexOf("World") // 6
"Hello World".charAt(6) // "W"
"Hello World".substring(6, 11) // "World"
"Hello World".replace("World", "there") // "Hello there"
</code></pre>

</section>

<section>
<h1>Arrays</h1>

<p>Listen von Werten beliebigen Typs</p>

<pre><code class="javascript">var array = [1, 2, 3];
alert(array); // 1,2,3
alert(array.join(',')); // 1,2,3
alert(array.length); // 3
alert(array[0]); // 1
alert(array.indexOf(3)); // 2
</code></pre>
</section>

<section>
<h1>Arrays</h1>
<pre><code class="javascript">var array = [1, 2, 3];
// Iteration mit for-Schleife
for (var i = 0, l = array.length; i &lt; l; i++) {
  alert(i + ": " + array[i]);
}
// Iteration mit Callback-Funktion
array.forEach(function (el, i, array) {
  alert(i + ": " + el);
});
// Listenoperationen (map, filter, reduce…)
var newArray = array.filter(function (el) {
  return el &gt; 1;
});
alert(newArray); // 2,3
</code></pre>
</section>

<section>
<h1>Objekt-Literale</h1>
<pre><code class="javascript">var objekt = {
  eigenschaft: wert,
  property: value,
  …
};
alert(objekt.eigenschaft);
objekt.eigenschaft = …;
objekt.neueEigenschaft = …;
delete objekt.eigenschaft;
</code></pre>
<p>Hashes / Hash Maps / assoziative Arrays</p>
</section>

<section>
<h1>Objekte</h1>
<ul>
  <li>Alles in JavaScript ist oder verhält sich wie ein Objekt</li>
  <li>Alle Objekte verhalten sich gleich</li>
  <li>Die meisten Objekte sind veränderbar
    <ul>
      <li>Neue Eigenschaften können angelegt oder gelöscht werden</li>
      <li>Eigenschaften sind schreibbar</li>
    </ul>
  </li>
  <li>Objekte sind sowohl Arbeitsdaten als auch Programmstruktur</li>
</ul>
</section>

<section>
<h1>Objekt-Literale</h1>
<pre><code class="javascript">var person = {
  name: 'Mathias',
  postcode: 44793,
  employer: '9elements',
  languages: ['JavaScript', 'Ruby'],
  greet: function () {
    alert('Hallo von ' + this.name);
  }
};
person.greet();
</code></pre>
<p>Eines der mächtigsten Features von JavaScript</p>
</section>

<section>
<h1>JSON</h1>

<p>JavaScript Object Notation</p>

<p>Untermenge von JavaScript</p>

<pre><code class="javascript">[
  { "name": "Mathias", "postcode": 44793,
    "languages": [ "JavaScript", "Ruby" ] },
  { "name": "Lena", "postcode": 10711,
    "languages": [ "Objective-C", "Java" ] }
]
</code></pre>

<p><code>JSON.stringify()</code> und <code>JSON.parse()</code></p>

</section>

<section>
<h1>Referenzen</h1>

<ul>
  <li><a href="https://developer.mozilla.org/en-US/docs/JavaScript">Mozilla Developer Network (MDN)</a></li>
  <li><a href="http://msdn.microsoft.com/en-us/library/yek4tbz0(v=vs.94).aspx">Microsoft Developer Network (MSDN)</a></li>
  <li><a href="http://de.selfhtml.org/javascript/objekte/">SELFHTML</a> (lückenhaft, aber Grundlagen)</li>
</ul>

</section>

<!-- ******************************************************************** -->

<section>
<h1>JavaScript in HTML</h1>

<pre><code class="html">&lt;script&gt;
window.alert("Hello World!");
&lt;/script&gt;
</code></pre>

<pre><code class="html">&lt;script src="script.js"&gt;&lt;/script&gt;
</code></pre>

</section>

<section>
<h1>JavaScript in HTML5</h1>

<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html lang="de"&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;Titel&lt;/title&gt;
    &lt;link rel="stylesheet" src="style.css"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Titel&lt;/h1&gt;
    &lt;p&gt;Inhalt&lt;/p&gt;
    &lt;script src="script.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>»Put Stylesheets at the Top,<br />Put Scripts at the Bottom«</p>

</section>

<section>
<h1>JavaScript im Browser</h1>
<ul>
  <li>Kernobjekte aus ECMAScript</li>
  <li>Fenster (<code>window</code>)</li>
  <li>Dokumente (<code>window.document</code>)</li>
  <li>DOM-Knotenbaum (u.a. HTML-Elemente)</li>
  <li>Entwicklertools wie Firebug und DOM Inspector verwenden</li>
</ul>
</section>

<section>
<h1>DOM</h1>

<ul>
  <li>Document Object Model</li>
  <li>Die JavaScript-Schnittstelle zum HTML-Dokument, in dem das Script läuft</li>
  <li>Ein Baum von Knoten (Elemente, Text, Kommentare usw.)</li>
</ul>
</section>

<section>
<h1>DOM</h1>

<pre><code class="html">&lt;p id="content"&gt;Hello World&lt;/p&gt;
</code></pre>

<pre><code class="javascript">var el = document.getElementById('content');
alert(el.nodeName); // P
alert(el.childNodes.length); // 1
alert(el.innerHTML); // Hello World
el.innerHTML = 'Hallo Welt!';
</code></pre>

<pre><code class="javascript">var strong = document.createElement('strong');
var text = document.createTextNode('Hallo Welt!');
strong.appendChild(text);
el.appendChild(strong);
</code></pre>

</section>

<section>
<h1>jQuery (<a href="http://jquery.com">jquery.com</a>)</h1>
<ul>
  <li>Ausgereiftes Standardtool für DOM- und Ajax-Operationen</li>
  <li>Das DOM ist umständlich und Low-Level</li>
  <li>jQuery bietet eine kompakte Syntax und ist browserübergreifend</li>
</ul>
</section>

<section>
<h1>Vorteile von jQuery</h1>
<ul>
  <li>Schneller Einstieg</li>
  <li>Knapper, verständlicher Code</li>
  <li>Häufige Aufgaben einfach lösen</li>
  <li>Etablierte gute Konventionen und vereinheitlicht Code</li>
  <li>Zahlreiche Erweiterungen (Plugins)</li>
</ul>
</section>

<section>
<h1>Grenzen von jQuery</h1>

<ul>
  <li>Deckt nur einen kleinen Bereich ab</li>
  <li>jQuery-Code skaliert nicht, wird schlecht wartbar</li>
  <li>jQuery bietet (fast) nichts zur Strukturierung</li>
  <li>Umfangreich und komplex</li>
</ul>
</section>

<section>
<h1>jQuery-Features</h1>
<ul>
  <li>Elemente mittels CSS-Selektoren finden</li>
  <li>DOM-Traversal (Bewegen im DOM-Baum)</li>
  <li>DOM-Manipulation (Elemente einfügen, Inhalte wechseln, Attribute setzen)</li>
  <li>CSS-Eigenschaften ändern, CSS-Animationen</li>
  <li>Event-Handling (z.B. Maus- und Tastaturevents), Event-Delegation</li>
  <li>HTTP-Anfragen an Server senden (Ajax)</li>
</ul>
</section>

<section>
<h1>jQuery-Grundlagen</h1>

<p><code>$("#content")</code></p>

<ul>
  <li>findet das Element mit der ID <code>content</code></li>
  <li>gibt ein <code>jQuery</code>-Objekt zurück</li>
  <li>das ist eine Liste mit Elementobjekten (DOM-Knoten)</li>
  <li><code>$()</code> ist kurz für <code>jQuery()</code></li>
</ul>
</section>

<section>
<h1>jQuery-Beispiel</h1>

<pre><code class="html">&lt;p id="content"&gt;Hello World&lt;/p&gt;
</code></pre>

<pre><code class="html">&lt;script&gt;
alert( $('#content').length ); // 1
alert( $('#content')[0] ); // [object HTMLParagraphElement]
&lt;/script&gt;
</code></pre>

<p>jQuery wrappt Elementobjekte in eine Listenobjekt mit vielen nützlichen Methoden</p>
</section>

<section>
<h1>jQuery-Beispiel</h1>

<pre><code class="html">&lt;p id="content"&gt;Hello World&lt;/p&gt;
</code></pre>

<pre><code class="javascript">alert( $('#content').html() ); // Hello World
$('#content').html('Hallo Welt!');
</code></pre>

<pre><code class="javascript">$('#content').click(function () {
  $(this).html(text);
});
</code></pre>

</section>

<section>
<h1>Beispiel: Bildergalerie</h1>

<ul>
  <li>Bildersuche bei Flickr</li>
  <li>Thumbnail-Liste</li>
  <li>Vollansicht bei Klick</li>
</ul>
</section>

<section>
<h1>Beispiel: Bildergalerie</h1>

<ol>
  <li>GET-Request auf die JSON-API von Flickr
  - <code>ajax()</code> oder <code>getJSON()</code></li>
  <li>HTML für Ergebnisse zusammenbauen und ins DOM einfügen
  - <code>html()</code> oder <code>append()</code></li>
  <li>Vollansicht bei Klick
  - <code>html()</code>, <code>click()</code></li>
</ol>
</section>

<section>
<h1>Helferlein</h1>

<ul>
  <li><a href="http://api.jquery.com">api.jquery.com</a></li>
  <li><a href="http://jqapi.ru/">jqapi.ru</a></li>
  <li><a href="http://oscarotero.com/jquery/">oscarotero.com/jquery/</a></li>
  <li><a href="http://developer.mozilla.org">developer.mozilla.org</a></li>
  <li>Debugger und Konsolen von Firebug und Web Inspector</li>
  <li>Debugging mit <code>alert('…');</code> und <code>console.log('…');</code></li>
</ul>
</section>

<!-- ******************************************************************** -->

<section>
<h1>JavaScripte strukturieren</h1>
<p>Objektorientierte und funktionale Programmierung</p>
</section>

<section>
<h1>Strukturierung</h1>
<ul>
  <li>ECMAScript 3 hat keine Klassen, Interfaces, Module, Traits, Mixins, Sichtbarkeit</li>
  <li>ECMAScript 3 hat Objekte, Funktionen, Konstruktoren, Prototypen</li>
</ul>
</section>

<section>
<h1>Neuere Standards</h1>
<ul>
  <li>ECMAScript 5 hat Getter/Setter, einfache Zugriffsrechte (Property Descriptors)</li>
  <li>ECMAScript 6 bekommt Module, Klassen als »Syntaxzucker«, private Eigenschaften, Proxies für Metaprogrammierung uvm.</li>
</ul>
</section>

<section>
<h1>Strukturierung</h1>
<ul>
  <li>ECMAScript 3 als Grundlage</li>
  <li>Module, Kapselung, Vererbung (Delegation), Pseudo-Klassen, Objekt-Komposition</li>
  <li>Imperativ statt deklarativ</li>
  <li>Konventionen und Code statt festen Sprachfeature</li>
  <li>Viele Möglichkeiten</li>
</ul>
</section>

<section>
<h1>Revealing Module Pattern</h1>

<pre><code class="javascript">var modul = (function () {
  var privateVariable = 1;
  var privateFunktion = function () {…};
  return {
    öffentlicheEigenschaft: 1,
    öffentlicheMethode: function () {…}
  };
})();
</code></pre>

</section>

<section>
<h1>Revealing Module Pattern</h1>

<ul>
  <li>Funktions-Scope für private Daten und Funktionen</li>
  <li>Selbstausführende Funktion mit Closures</li>
  <li>Gibt einen Object-Literal mit öffentlichen Eigenschaften und Methoden zurück</li>
</ul>

<p><a href="module-pattern.html" target="_blank">Demonstration</a>
&lt;/a&gt;</p>

</section>

<section>
<h1>Prototypen</h1>
<ul>
  <li>Jedes Objekt hat einen Prototypen-Verweis</li>
  <li>Der Prototyp ist ein normales Objekt</li>
  <li>Wenn eine Eigenschaft nicht gefunden wird, wird sie beim Prototypen gesucht (Delegation)</li>
  <li>So bekommen Objekte die Fähigkeiten beliebig vieler anderer Objekte</li>
</ul>
</section>

<section>
<h1>Prototypen</h1>

<ul>
  <li>JavaScript basiert intern auf Prototypen</li>
  <li>Die meisten Objekte erben ihre Methoden von Prototypen</li>
  <li>Die Prototypen der Kernobjekte sind lesbar und erweiterbar</li>
  <li><small><code>Object.prototype, Function.prototype, Array.prototype, String.prototype, HTMLDocument.prototype, HTMLElement.prototype</code> usw.</small></li>
</ul>
</section>

<section>
<h1>Prototypische Delegation</h1>

<p>Wie erzeuge ich ein Objekt, das an ein anderes delegiert?</p>

<ul>
  <li>Funktion, deren <code>prototype</code>-Eigenschaft und der <code>new</code>-Operator (ES3)</li>
  <li><code>Object.create()</code> (ES5)</li>
</ul>
</section>

<section>
<h1>Prototypen</h1>

<p>Wie bekomme ich den Prototyp eines Objekts?</p>

<ul>
  <li><code>obj.constructor.prototype</code> (ECMAScript 3)</li>
  <li><code>Object.getPrototypeOf(obj)</code> (ES5)</li>
  <li><code>obj.__proto__</code> (ES6, bereits viele Browser)</li>
</ul>

<p>In der ECMAScript-Spezifikation <code>[[Prototype]]</code> genannt.</p>
</section>

<section>
<h1>Prototypische Delegation</h1>

<pre><code class="javascript">var o1 = { name: 'o1' };
// Erzeuge ein leeres Objekt, das o1 als Prototyp hat
var o2 = Object.create(o1);

// o2 hat keine Eigenschaft »name«, delegiert an o1
alert(o2.name); // o1
alert(o2.hasOwnProperty("name")); // false

o2.name = "o2";
// o2 hat nun eine Eigenschaft »name«
alert(o2.name); // o2
alert(o2.hasOwnProperty("name")); // true
</code></pre>
</section>

<section>
<h1>Prototypenkette</h1>

<p>Ein Objekt hat einen Prototyp. Der Prototyp hat einen Prototyp usw. bis zum obersten Prototyp <code>Object.prototype</code>.</p>

<pre><code class="javascript">var o1 = { name: 'o1' };
var o2 = Object.create(o1);
o2.__proto__ === o1
o1.__proto__ === Object.prototype
</code></pre>

<p>o2 → o1 → Object.prototype</p>

<pre><code class="javascript">var str = "Hallo Welt!";
str.__proto__ === String.prototype
String.prototype.__proto__ === Object.prototype
</code></pre>

<p>str → String.prototype → Object.prototype
&lt;/code&gt;&lt;/pre&gt;</p>

</section>

<section>
<h1>Prototypen verstehen</h1>

<object type="image/svg+xml" data="images/prototypen-optimiert.svg" width="540" height="460"></object>

<p><a href="http://molily.de/js/organisation-instanzen.html">JavaScript-Dokumentation</a></p>

</section>

<section>
<h1>Prototypen</h1>

<p>Die Kern-Prototypen sind erweiterbar:</p>

<pre><code class="javascript">Array.prototype.max = function () {
  var i, l = this.length, biggest = 0, candidate;
  for (i = 0; i &lt; l; i++) {
    candidate = this[i];
    if (candidate &gt; biggest) {
      biggest = candidate;
    }
  }
  return biggest;
};
alert([6, 2, 9, 3].max());
</code></pre>

<p>Konflikte sind vorprogrammiert</p>

</section>

<section>
<h1>Pseudoklassen</h1>

<ul>
  <li>JavaScript hat keine Unterscheidung zwischen festen Typen und Exemplaren</li>
  <li>JavaScript kennt nur einfache, erweiterbare Objekte, die delegieren können</li>
  <li>Prototypische Delegation ist vielseitiger</li>
  <li>In der Anwendungsentwicklung wird mit Pseudoklassen gearbeitet</li>
  <li>Einfachvererbung, Konstruktoren, Destruktoren, Super-Calls</li>
</ul>
</section>

<section>
<h1>Pseudoklassen</h1>

<p>Konstruktoren, Prototypen, Instanzen</p>

<pre><code class="javascript">var Person = function (name) {
  this.name = name;
};

Person.prototype.greet = function () {
  alert("Hello, my name is " + this.name + "!");
};

var alice = new Person("Alice");
alice.greet();
</code></pre>

<p>alice → Person.prototype → Object.prototype</p>
</section>

<section>
<h1>Konstruktoren</h1>

<pre><code class="javascript">var Person = function (name) {
  this.name = name;
};
</code></pre>

<ul>
  <li>Konstruktoren sind normale Funktionen</li>
  <li>Über Konstruktoren lassen sich Typen definieren</li>
  <li>Konstruktoren sind Objektfabriken, sie erzeugen gleichförmige Objekte</li>
</ul>
</section>

<section>
<h1>Konstruktoren</h1>

<pre><code class="javascript">var Person = function (name) {
  this.name = name;
};
</code></pre>

<p>Konvention: Konstruktoren beginnen mit einem Großbuchstaben, um sie von normalen Funktionen zu unterscheiden</p>
</section>

<section>
<h1>Konstruktor.prototype</h1>

<pre><code class="javascript">Person.prototype.greet = function () {
  alert("Hello, my name is " + this.name + "!");
};</code></pre>

<ul>
  <li>Jede Funktion hat eine Eigenschaft <code>prototype</code></li>
  <li>Das ist ein einfaches, erweiterbares Objekt</li>
  <li>Definition von Methoden und Eigenschaften</li>
</ul>
</section>

<section>
<h1>Instanzen erzeugen</h1>

<pre><code class="javascript">var alice = new Person("Alice");
alice.greet();
</code></pre>

<ul>
  <li>Ein Aufruf des Konstruktors mit dem <code>new</code>-Operator erzeugt eine Instanz</li>
  <li>Erzeugt ein neues Objekt, das <code>Konstruktor.prototype</code> als Prototyp hat</li>
  <li>alice → Person.prototype</li>
  <li><code>alice.greet</code> kommt vom Prototypen</li>
</ul>
</section>

<section>
<h1>Prototypenkette</h1>
<p><img src="images/prototypenkette.png" alt="" />
<a href="pseudoklassen.html" target="_blank">Siehe Web Inspector</a></p>
</section>

<section>
<h1>Schlüsselwort this</h1>

<ul>
  <li><code>this</code> hat viele Bedeutungen</li>
  <li>Außerhalb von Funktionen: <code>window</code></li>
  <li>Innerhalb von Funktionen: Hängt von der Aufrufweise der Funktion ab.</li>
</ul>

<pre><code class="javascript">var f = function () { alert(this); };
var o = { f: f };
f();   // window bzw. undefined im Strict-Mode
o.f(); // o
</code></pre>

<ul>
  <li>Der Strict-Mode sorgt dafür, dass <code>this</code> nicht plötzlich <code>window</code> ist.</li>
</ul>
</section>

<section>
<h1>Programmieraufgabe</h1>

<p>Schreiben Sie eine Klasse <code>Robot</code>, die die Methoden <code>stepForward</code>, <code>turnLeft</code>, <code>turnRight</code> und <code>showLog</code> implementiert. Die ersten drei speichern die Bewegung intern und geben eine Bestätigung aus. Die Methode <code>showLog</code> gibt auf der Konsole eine Liste aller aufgezeichneten Bewegungen aus. (Keine Visualisierung.)</p>
</section>

<section>
<h1>Tipps</h1>

<ul>
  <li>Konstruktor <code>Robot</code></li>
  <li><code>Robot.prototype.methode = function () {…};</code></li>
  <li>Eigenschaft <code>this.log = [];</code></li>
  <li>Methoden fügen Aktionen zum Log hinzu: <code>this.log.push('action');</code></li>
  <li>Ausgabe mit <code>console.log(this.log.join(', '));</code></li>
</ul>

<p><a href="pseudoklassen-emma.html" target="_blank">Beispiellösung</a></p>
</section>

<section>
<h1>Pseudoklassen</h1>

<ul>
  <li>Warum ist das so umständlich mit Konstruktoren, <code>prototype</code> und <code>new</code>?</li>
  <li><q>The pseudoclassical form can provide comfort to programmers who are unfamiliar with JavaScript, but it also hides the true nature of the language.</q><br />– <cite>Douglas Crockford: JavaScript. The Good Parts</cite></li>
  <li>Verzicht auf Konstruktoren zugunsten von <a href="http://uxebu.com/blog/2011/02/23/object-based-inheritance-for-ecmascript-5/">Object.create()</a></li>
</ul>
</section>

<section>
<h1>Literatur</h1>

<ul>
  <li>Organisation von JavaScripten</li>
  <li><a href="http://molily.de/js/organisation-instanzen.html">Konstruktoren, Prototypen und Instanzen</a></li>
  <li><a href="http://molily.de/js/organisation-verfuegbarkeit.html">Ebenda: Objektverfügbarkeit und this-Kontext</a></li>
  <li><a href="http://molily.de/javascript-core/">Die Grundlagen von JavaScript</a> (dt. Übersetzung)</li>
</ul>
</section>

<section>
<h1>OOP-Werkzeuge</h1>

<ul>
  <li>Klassenhierarchien, Mehrfachvererbung, Mixins, Traits, AOP</li>
  <li><a href="http://molily.de/weblog/javascript-pseudoklassen">Helfer für simple Vererbung</a></li>
  <li><a href="http://documentcloud.github.com/backbone/#Model-extend">Backbones extend()</a></li>
  <li><a href="http://dojotoolkit.org/documentation/tutorials/1.7/declare/">Dojo</a> / <a href="https://github.com/kriszyp/compose">compose</a></li>
  <li><a href="http://www.prototypejs.org/learn/class-inheritance">PrototypeJS</a> / <a href="http://www.peterkroener.de/mootools-fuer-die-massen-teil-4-klassen-erstellen-und-erweitern/">Mootools</a></li>
  <li><a href="http://molily.de/weblog/yui3-oop">Yahoo YUI</a></li>
  <li><a href="http://soft.vub.ac.be/~tvcutsem/traitsjs/">Traits</a> / <a href="https://github.com/raganwald/method-combinators">Method combinators</a></li>
  <li><a href="http://jsclass.jcoglan.com/">JSClass</a></li>
</ul>
</section>

<!-- ******************************************************************** -->

<section>
<h1>Funktionale Programmierung</h1>

<ul>
  <li>Funktionen als »first-class citizens«</li>
  <li>Vollwertige Objekte, zur Laufzeit erzeugen</li>
  <li>Higher-order functions: Funktionen können Parameter und Rückgabewerte sein</li>
  <li>Anonym oder benannt, Auto-Referenzialität für Rekursion</li>
  <li>Closures</li>
  <li>Verschachtelung und »Callback Hell«</li>
</ul>
</section>

<section>
<h1>Funktionale Programmierung</h1>

<pre><code class="javascript">var plusTwo = function (addend) {
  return addend + 2;
};
var createMultiplier = function (f1) {
  return function (f2) {
    return f1 * f2;
  };
};
var timesTwo = createMultiplier(2);
var compose = function (f1, f2) {
  return function (arg) {
    return f1(f2(arg));
  };
};
var plusTwoTimesTwo = compose(timesTwo, plusTwo);
alert(plusTwoTimesTwo(2)); // 8
</code></pre>
</section>

<section>
<h1>Zusammenfassung</h1>

<ul>
  <li>Objekte zur Programmstrukturierung</li>
  <li>Funktionen und Closures für private Daten</li>
  <li>Funktionale Programmierung</li>
  <li>Prototypen für Code-Wiederverwendung und Pseudoklassen</li>
</ul>

<p><a href="http://molily.de/js/organisation-ueberblick.html#grundpfeiler">Grundpfeiler</a></p>
</section>

<!-- ******************************************************************** -->

<section>
<h1>JavaScript-Anwendungen</h1>

<ul>
  <li>Komfortable, leistungsfähige Anwendungen im Browser</li>
  <li>Gewohnte Interfaces, bessere Bedienbarkeit</li>
  <li>Synchronisierung mit dem Server im Hintergrund</li>
  <li>Wenige oder keine Seitenwechsel: Single-Page-Apps</li>
  <li>JavaScript lädt Daten und rendert das HTML</li>
  <li><a href="http://moviepilot.com">moviepilot.com</a>, <a href="http://m.falk.de/">m.falk.de</a>, <a href="http://salon.io">salon.io</a></li>
</ul>
</section>

<section>
<h1>Anwendungsentwicklung</h1>

<ul>
  <li>Entwurfsmuster (design patterns)</li>
  <li>Wartbarkeit und Skalierbarkeit</li>
  <li>Performance und Memory-Management</li>
  <li>Browser-Kompatibilität</li>
  <li>Unit Testing, TDD</li>
  <li>Entwicklungsumgebungen</li>
</ul>
</section>

<section>
<h1>JavaScript-Anwendungen</h1>

<ul>
  <li>Anwendungsstruktur</li>
  <li>OOP und funktionale Programmierung</li>
  <li>DOM Scripting, HTML-Templates</li>
  <li>Routing und History</li>
  <li>Modularisierung und Dependencies</li>
  <li>API-Kommunikation</li>
  <li>Building und Packaging</li>
</ul>
</section>

<section>
<h1>Model View Controller</h1>

<ul>
  <li>Bewährtes Pattern für grafische Benutzeroberflächen</li>
  <li>Model: Rohdaten und deren Logik</li>
  <li>View: Darstellung der Daten, User Interface</li>
  <li>Controller: Benutzeraktionen auswerten, Daten manipulieren</li>
  <li>Controller erzeugt Model und View, View überwacht das Model</li>
  <li><a href="https://github.com/dira/do-mvc-right/blob/master/2013-02-28-mvc-dira.pdf?raw=true">MVC im Kontext von JavaScript verstehen</a></li>
</ul>
</section>

<section>
<h1>Backbone.js (<a href="http://backbonejs.org">backbonejs.org</a>)</h1>

<ul>
  <li>Einfache und kleine Bibliothek (1.650 Zeilen)</li>
  <li>Bekannt und erprobt</li>
  <li>Aktive Entwicklung</li>
  <li>Lesbarer, getesteter Code</li>
  <li>Kostenlos und Open Source</li>
  <li>Ähnlich: Spine, CanJS</li>
</ul>
</section>

<section>
<h1>Backbones Abhängigkeiten</h1>

<ul>
  <li>Underscore, Lodash…
    <ul>
      <li>Werkzeugkasten für funktionale und OOP</li>
    </ul>
  </li>
  <li>jQuery, Zepto, Ender…
    <ul>
      <li>für DOM Scripting und Ajax</li>
    </ul>
  </li>
  <li>_.template, Mustache, Handlebars…
    <ul>
      <li>für HTML-Templates</li>
    </ul>
  </li>
</ul>
</section>

<section>
<h1>Backbones Grundideen</h1>

<ul>
  <li>Die Trennung von Models und Views<br />(Separation of Concerns)</li>
  <li><em>Models</em> laden, verarbeiten und speichern die Daten</li>
  <li><em>Views</em> stellen Daten im DOM dar und erzeugen das User Interface</li>
  <li><em>Router/History</em> synchronisiert den Anwendungsstatus mit der URL</li>
</ul>
</section>

<section>
<h1>Backbone-Übersicht</h1>

<p><img src="images/backbone.png" alt="" /></p>
</section>

<section>
<h1>Backbone.Events</h1>

<ul>
  <li>Basis für eine Event-basierte Architektur</li>
  <li>Event-Handler registrieren und Events feuern</li>
  <li>Backbones Kernfeature, benutzt von allen anderen Klassen</li>
  <li>Komponenten kommunizieren über Events miteinander</li>
  <li>Methoden: <code>on</code>, <code>off</code>, <code>trigger</code>, <code>listenTo</code></li>
</ul>
</section>

<section>
<h1>Models</h1>

<ul>
  <li>Abrufen, Verarbeiten und Speichern von Daten</li>
  <li>Models sind die »einzige Quelle der Wahrheit«</li>
  <li>Daten werden nicht im DOM gespeichert</li>
  <li>Kernfeature: Das <code>attributes</code>-Objekt</li>
  <li>Attribute lesen und schreiben mit <code>get()</code> und <code>set()</code></li>
  <li>Änderungen erzeugen <code>change</code>-Events</li>
</ul>
</section>

<section>
<h1>Models</h1>

<pre><code class="javascript">// Subclassing mit extend()
var Car = Backbone.Model.extend();
// Instanz mit vordefinierten Attributen
var car = new Car({
  name: 'DeLorean DMC-12',
  manufactured: 1981
});
// Attribut lesen
console.log( car.get('name') );
// Attribute schreiben
car.set('manufactured', 1982);   // Ein Attribut
car.set({ manufactured: 1982 }); // Mehrere Attribute
console.log( car.get('manufactured') );
</code></pre>

<p><a href="model.html" target="_blank">Demonstration</a></p>
</section>

<section>
<h1>Models laden und speichern</h1>

<ul>
  <li>Synchronisierung über RESTful HTTP mit JSON</li>
  <li><code>urlRoot</code> angeben, z.B. <code>cars</code></li>
  <li><code>model.fetch()</code> erzeugt ein <code>GET /cars/:id</code></li>
  <li><code>model.save()</code> erzeugt ein <code>POST/PUT /cars/:id</code></li>
  <li><code>model.destroy()</code> erzeugt ein <code>DELETE /cars/:id</code></li>
</ul>
</section>

<section>
<h1>Models laden und speichern</h1>

<pre><code class="javascript">var Car = Backbone.Model.extend({
  urlRoot: '/cars'
});
model.fetch().then(successCallback, failCallback);
model.save().then(successCallback, failCallback);
model.destroy().then(successCallback, failCallback);
</code></pre>

<p><a href="http://promises-aplus.github.io/promises-spec/">Promises</a> / <a href="http://api.jquery.com/category/deferred-object/">jQuery Deferreds</a></p>
</section>

<section>
<h1>Model-Events überwachen</h1>

<pre><code class="javascript">car.on('change', function (car, options) {
  console.log('Some attribute changed');
});
car.on('change:manufactured', function (car, newValue, options) {
  console.log('manufactured changed:', newValue);
});
car.set({ manufactured: 1982 });
</code></pre>

<p><a href="model-events.html" target="_blank">Demonstration</a></p>
</section>

<section>
<h1>Collections</h1>

<ul>
  <li>Eine Liste von Models</li>
  <li>Feuert die Events <code>add</code>, <code>remove</code> and <code>reset</code></li>
  <li>Kurz gesagt, ein überwachbarer Array</li>
  <li>Listen-Helfer (<code>each</code>, <code>map</code>, <code>reduce</code>, <code>sort</code>, <code>filter</code>…)</li>
</ul>
</section>

<section>
<h1>Collections</h1>

<pre><code class="javascript">var Car = Backbone.Model.extend();

var Cars = Backbone.Collection.extend({ model: Car });

var cars = new Cars([
  { name: 'DeLorean DMC-12', manufactured: 1981 },
  { name: 'Chevrolet Corvette', manufactured: 1953 }
]);
alert( cars.at(0).get('name') ); // DeLorean DMC-12
cars.push({ name: 'VW Scirocco', manufactured: 1974 });
alert( cars.length ); // 3
</code></pre>

</section>

<section>
<h1>Views</h1>

<ul>
  <li>Eine View verwaltet ein Element (<code>this.el</code>, <code>this.$el</code>)</li>
  <li>Darstellung der Modeldaten (Render-Pattern)</li>
  <li>Referenz auf ein Model oder eine Collection</li>
  <li>Verarbeitet DOM-Events (Nutzereingaben)</li>
  <li>Überwacht Model-Events (Model-View-Binding)</li>
  <li>Ruft Model-Methoden auf oder emittiert Events</li>
</ul>
</section>

<section>
<h1>Einfache View ohne Template</h1>

<pre><code class="javascript">var CarView = Backbone.View.extend({
  initialize: function () {
    // Überwache Model-Änderungen: Neu rendern
    this.listenTo(this.model, 'change', this.render);
  },
  render: function () {
    this.$el.html('Name: ' + this.model.get('name'));
  }
});
var carView = new CarView({
  model: car,
  el: $('#car')
});
carView.render();
</code></pre>

<p><a href="view.html" target="_blank">Demonstration</a></p>
</section>

<section>
<h1>Templates</h1>

<p>Views übersetzen Modeldaten in HTML mithilfe eines Templates</p>

<table>
  <tr>
    <th>Modeldaten:
    <td><code>{ message: 'Hello World' }</code>
  <tr>
    <th>Template:
    <td><code>&lt;p&gt;{{message}}&lt;/p&gt;</code>
  <tr>
    <th>Ausgabe:
    <td><code>&lt;p&gt;Hello World&lt;/p&gt;</code>
&lt;/table&gt;

Der erzeugte HTML-Code wird ins DOM eingefügt
&lt;/code&gt;&lt;/pre&gt;

</td></th></tr></td></th></tr></td></th></tr></table>
</section>

<section>
<h1>View mit Template</h1>

<pre><code class="javascript">var CarView = Backbone.View.extend({
  <strong>template: _.template('Name: {{name}}'),</strong>
  initialize: function () {
    this.listenTo(this.model, 'change', this.render);
  },
  render: function () {
    this.$el.html(<strong>this.template</strong>(this.model.attributes));
  }
});
var carView = new CarView({
  model: car,
  el: $('#car')
});
carView.render();
</code></pre>

<p><a href="view-template.html" target="_blank">Demonstration</a></p>
</section>

<section>
<h1>Model-View-Binding</h1>

<ul>
  <li>Muss bei Backbone manuell eingerichtet werden</li>
  <li>Eine View hört auf Model-Änderungen und rendert sich neu oder aktualisiert das DOM</li>
  <li><code>this.listenTo(this.model, 'change', this.changeHandler)</code></li>
  <li>Eine View hört auf Nutzereingaben und ruft Model-Methoden auf oder feuert Events beim Model</li>
</ul>

<p><a href="binding.html" target="_blank">Demonstration</a></p>
</section>

<section>
<h1>Grenzen von Backbone</h1>

<p><q>Backbone.js gives structure … by providing models with key-value binding and custom events, collections with a rich API of enumerable functions, views with declarative event handling, and connects it all to your existing API over a RESTful JSON interface.</q> – <cite>backbonejs.org</cite></p>

<p>Das ist alles (plus Routing).</p>
</section>

<section>
<h1>Nachteile von Backbone</h1>

<ul>
  <li>Mit Absicht sehr minimalistisch und offen</li>
  <li>Überlässt einem viele Entscheidungen, bietet wenig Orientierung</li>
  <li>Keine Patterns zur Strukturierung der Anwendung auf oberster Ebene</li>
  <li>Kein klassisches MVC, MVP oder MVVM</li>
  <li>»There’s More Than One Way To Do It« vs. »Convention Over Configuration«</li>
  <li>Backbone alleine reicht nicht, ist aber eine gute Grundlage</li>
</ul>
</section>

<section>
<h1>Application Frameworks</h1>

<p>Auf Basis von Backbone</p>

<ul>
  <li><a href="https://github.com/marionettejs/backbone.marionette">Marionette</a></li>
  <li><a href="https://github.com/chaplinjs/chaplin">Chaplin</a></li>
  <li><a href="https://github.com/walmartlabs/thorax">Thorax</a></li>
  <li><a href="https://github.com/addyosmani/aura">Aura</a></li>
</ul>
</section>

<section>
<h1>Zusammenfassung</h1>

<ul>
  <li>Backbone als MV*-Framework</li>
  <li><code>var Car = Backbone.Model.extend({…});</code></li>
  <li><code>var CarView = Backbone.View.extend({…});</code></li>
  <li>Model-View-Binding</li>
  <li>Rendering und Templates</li>
  <li>Backbone bietet keine übergreifende Struktur</li>
</ul>
</section>

<section>
<h1>Chaplin.js (<a href="http://chaplinjs.org">chaplinjs.org</a>)</h1>

<ul>
  <li>Anwendungsarchitektur auf Basis von Backbone</li>
  <li>Best Practices und Konventionen</li>
  <li>In CoffeeScript und AMD geschrieben</li>
  <li>Entstanden aus moviepilot.com</li>
  <li>Open Source, automatisiert getestet</li>
</ul>
</section>

<section>
<h1>Chaplin.js</h1>

<p><img src="images/chaplin-architecture.png" alt="" /></p>
</section>

<section>
<h1>Chaplin-Komponenten (1)</h1>

<ul>
  <li><em>Application</em> startet die Kernkomponenten</li>
  <li><em>Router</em> überwacht URL-Änderungen und prüft, ob Routen auf die URL passen</li>
  <li><em>Dispatcher</em> startet und verwaltet Controller wenn Routen passen</li>
  <li><em>Controller</em> erzeugen Models und Views</li>
</ul>
</section>

<section>
<h1>Chaplin-Komponenten (2)</h1>

<ul>
  <li><em>Composer</em> zum Wiederverwenden von Models/Views zwischen Controllern</li>
  <li><em>Layout</em> ist die oberste View, fängt Klicks auf Links ab</li>
  <li><em>Regions</em> sind benannte Bereiche im UI, die gefüllt werden können (z.B. <code>main-content</code>, <code>sidebar</code>)</li>
  <li><em>mediator</em> zur Kommunikation via Publish/Subscribe</li>
</ul>
</section>

<section>
<h1>Routing-Ablauf</h1>

<p>Router ⇢ Dispatcher → Controller → Model/View</p>

<table>
  <tr>
    <th>&#x21E2;
    <td>benachrichtigt
  &lt;/tr&gt;
  <tr>
    <th>&rarr;
    <td>erzeugt
  &lt;/tr&gt;
&lt;/table&gt;
</td></th></tr></td></th></tr></table>
</section>

<section>
<h1>Routen</h1>

<ul>
  <li>Konfigurationsdatei <code>routes.js</code></li>
  <li>ähnelt <code>routes.rb</code> in Rails</li>
</ul>

<pre><code class="javascript">match('', 'homepage#show');
match('cars', 'cars#index');
match('cars/:id', 'cars#show');</code></pre>

<ul>
  <li>Pfad <code>/</code> – Controller <code>homepage</code> – Action <code>show</code></li>
  <li>Pfad <code>/cars</code> – Controller <code>cars</code> – Action <code>index</code></li>
  <li>Pfad <code>/cars/:id</code> – Controller <code>cars</code> – Action <code>show</code></li>
</ul>
</section>

<section>
<h1>Controller</h1>

<pre><code class="javascript">var CarsController = Controller.extend({

  // cars/1
  // cars/:id
  show: function (params) {
    this.car = new Car({ id: params.id });
    this.view = new CarView({ model: this.car });
  }

});
</code></pre>

</section>

<section>
<h1>Controller</h1>

<ul>
  <li>Erzeugen Models/Collections (<code>this.model</code>/<code>this.collection</code>)</li>
  <li>Erzeugen die Haupt-View (<code>this.view</code>)</li>
  <li>Methoden sind Actions</li>
  <li>Nehmen URL-Parameter entgegen</li>
</ul>
</section>

<section>
<h1>Controller</h1>

<ul>
  <li>Ein aktiven Controller, der die Haupt-View erzeugt</li>
  <li>Beim Starten eines Controllers wird der vorherige Controller mitsamt Models und Views abgebaut</li>
  <li>Models und Views können kontrolliert wiederverwendet werden (Composer)</li>
  <li>Persistente Controller sind möglich</li>
</ul>
</section>

<section>
<h1>Object Disposal</h1>

<ul>
  <li>Definierter Lebenszyklus von Controllern, Models und Views</li>
  <li>Alle Komponenten haben eine <code>dispose</code>-Methode als Destructor</li>
  <li>Garbage Collection ermöglichen zur Vermeidung von Memory-Leaks</li>
  <li>Wichtig bei Event-basierten Architekturen</li>
  <li>Chaplin wirft per default alles weg</li>
</ul>
</section>

<section>
<h1>Mediator</h1>

<ul>
  <li>MVC-Komponenten haben keine Referenzen aufeinander</li>
  <li>Ein drittes Objekt zum Datenaustausch</li>
  <li>Publish/Subscribe-Pattern</li>
  <li><code>mediator.publish()</code>, <code>mediator.subscribe()</code></li>
  <li>In Models, Collections und Views: <code>this.subscribeEvent()</code>, <code>this.publishEvent()</code></li>
  <li>Zentrale geteilte Objekte: <code>mediator.user</code></li>
</ul>
</section>

<section>
<h1>Modularisierung</h1>

<ul>
  <li>Chaplin nutzt die Modulstandards CommonJS bzw. AMD</li>
  <li>Abhängigkeiten zwischen Klassen deklarieren</li>
  <li>Abhängigkeitsbaum maschinell auslesen</li>
  <li>Richtige Ladereihenfolge der Scripte</li>
  <li>Lazy-Loading von Abhängigkeiten</li>
  <li>Packaging mehrerer Module in einer Datei</li>
</ul>
</section>

<section>
<h1>AMD: <code>require()</code></h1>

<p>Module asynchron laden und dann Code ausführen</p>

<pre><code class="javascript">require(dependencies:Array, callback:Function)
</code></pre>

<pre><code class="javascript">require(['application'], function(Application) {
  var app = new Application();
  app.initialize();
});</code></pre>
</section>

<section>
<h1>AMD: <code>define()</code></h1>

<p>Module mit Abhängigkeiten definieren</p>

<pre><code class="javascript">define(name:String, dependencies:Array, callback:Function)
define(dependencies:Array, callback:Function) // Name implizit</code></pre>

<p><code>controllers/hello_world_controller.js</code></p>

<pre><code class="javascript">define(
  [
    'controllers/base/controller',
    'models/hello_world',
    'views/hello_world_view'
  ],
  function (Controller, HelloWorld, HelloWorldView) {
    'use strict';
    var HelloWorldController = Controller.extend({ … });
    return HelloWorldController;
  }
);</code></pre>
</section>

<section>
<h1>AMD-Modulkonventionen</h1>

<ul>
  <li>Chaplin besteht aus Modulen</li>
  <li>Jede Klasse oder Singleton-Objekt ist ein Modul</li>
  <li>Eine Klasse pro Datei, ein <code>define()</code> pro Datei</li>
  <li>Der Name ist implizit und entspricht dem Dateipfad ohne Endung,<br />z.B. <code>controllers/hello_world_controller</code></li>
</ul>
</section>

<section>
<h1>AMD-Bibliotheken</h1>

<ul>
  <li><a href="http://requirejs.org/">Require.js</a> – browserseitiger AMD-Loader</li>
  <li><a href="https://github.com/cujojs/curl">curl.js – Alternative</a></li>
  <li><a href="http://requirejs.org/docs/optimization.html">r.js</a> – Pakete aus AMD-Modulen schnüren</li>
  <li><a href="https://github.com/jrburke/almond">Almond.js</a> – browserseitige Minimalimplementierung ohne Loader</li>
  <li><a href="http://browserify.org/">Browserify</a> – Pakete aus CommonJS-Modulen schnüren</li>
</ul>

</section>

<section>
<h1>AMD-Beispiel</h1>

<p><a href="amd.html" target="_blank">Demonstration</a></p>
</section>

<section>
<h1>Chaplin-Views</h1>

<ul>
  <li>Vordefinierte <code>render</code>-Methode</li>
  <li>Deklaratives Event-Handling:<br /><code>events</code> und <code>listen</code></li>
  <li>Optionen: <code>autoRender</code> und <code>container</code></li>
  <li>Subviews mit der <code>subview</code>-Methode</li>
</ul>
</section>

<section>
<h1>Chaplin-Boilerplate</h1>

<ul>
  <li><a href="https://github.com/chaplinjs/chaplin-boilerplate-plain">github.com/chaplinjs/chaplin-boilerplate-plain</a></li>
  <li>Hello-World-Beispiel</li>
  <li>Application, Routes, Controller, Model, View</li>
  <li>Handlebars.js als Templating-Engine</li>
</ul>
</section>

<section>
<h1>Beispielanwendung mit Chaplin</h1>

<ul>
  <li><a href="https://github.com/molily/chaplin-cars">github.com/molily/chaplin-cars</a></li>
  <li>Create, Read, Update, Delete (CRUD)</li>
  <li>Listenansicht, Einzelansicht, Editieransicht</li>
  <li>Hinzufügen von neuen Einträgen</li>
  <li>Vorgegebene Daten, kein Server, Persistenz mit <code>localStorage</code></li>
</ul>
</section>

<!-- ******************************************************************** -->

      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,
        rollingLinks: false,

        theme: 'simple',
        transition: 'fade',

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });

    </script>

  </body>
</html>
